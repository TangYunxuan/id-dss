import{d as P,u as q,r as f,i as J,f as Y,c as o,a as t,j as v,t as c,F as C,l as z,p as K,e as x,o as r,x as Q,s as j,w as M,v as S}from"./index-DdIWtqB0.js";import{g as W,s as X,b as Z}from"./api-D7Pu94V5.js";import{s as m}from"./text-B6rfVV0Y.js";const ee={class:"animate-fade-in"},te={key:0,class:"mb-6 p-4 rounded-lg bg-amber-50 border border-amber-200"},se={class:"flex items-start gap-3"},ne={class:"text-sm text-amber-700 mt-1"},ae={class:"card p-6 mb-6"},oe={class:"flex items-center justify-between"},re=["disabled"],ie={key:0,class:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24"},le={key:1,class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},de={key:1,class:"mb-6 p-4 rounded-lg bg-red-50 border border-red-200 text-red-700 text-sm"},ue={key:2,class:"card p-6 mb-6"},ce={key:0,class:"mb-3"},me={class:"text-sm text-surface-600"},pe={key:1},fe={class:"text-sm text-surface-600"},ve={key:3,class:"space-y-4 mb-6"},ge={class:"flex items-start gap-4"},xe={class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},be=["d"],he={class:"flex-1 min-w-0"},ke={class:"flex items-center gap-3 mb-2"},_e={key:0,class:"font-semibold text-surface-900"},we=["onUpdate:modelValue"],ye={key:0,class:"space-y-3 mb-3"},Ce={class:"grid sm:grid-cols-2 gap-3"},je=["onUpdate:modelValue"],Me=["onUpdate:modelValue"],Se=["onUpdate:modelValue"],Ae=["onUpdate:modelValue"],Ve={class:"text-sm text-surface-600 mb-3"},Le={class:"flex items-center gap-4 text-xs text-surface-500 mb-3"},Be={class:"flex items-center gap-1"},He={class:"badge badge-neutral"},ze={key:2,class:"mb-3"},Ge={class:"flex flex-wrap gap-1"},Te={key:3,class:"text-xs text-surface-500"},Ie={class:"flex items-center gap-2 flex-shrink-0"},Ue=["onClick"],$e=["onClick"],Ne=["onClick","disabled"],De=["onClick"],Ee=["onClick","disabled"],Re=["onClick"],Fe={key:4,class:"card p-12 text-center mb-6"},Oe={class:"flex justify-between"},Ke=P({__name:"ActivitySuggestionView",setup(Pe){const L=Y(),d=q(),b=f(!1),h=f(null),B=f(null),H=f(null),p=f(""),u=f([]),k=f(""),_=f("");J(async()=>{var n;if(!d.hasActiveSession){L.push("/new-session");return}try{h.value=await W()}catch(e){console.error("Failed to get LLM status:",e)}(n=d.activitySuggestions)!=null&&n.length&&(u.value=d.activitySuggestions.map((e,a)=>({id:`activity-${a}`,...e,status:"pending"})))});async function G(){var n,e;if(d.sessionId){b.value=!0,p.value="";try{u.value=[],k.value="",_.value="";const a=await X(d.sessionId,d.courseContext.learning_objectives);B.value=a.step_id,H.value=a.recommendation_id;const s=a.data;k.value=m(s.sequence_rationale||""),_.value=m(s.total_estimated_time||"");const g=(s.activities||[]).map(l=>{var i,V;return{...l,title:m(l.title||""),type:m(l.type||""),description:m(l.description||""),duration:m(l.duration||""),assessment_criteria:m(l.assessment_criteria||""),objective_alignment:(l.objective_alignment||[]).map(y=>m(y||"")).filter(Boolean),materials_needed:(l.materials_needed||[]).map(y=>m(y||"")).filter(Boolean),instructions:(l.instructions||[]).map(y=>m(y||"")).filter(Boolean),adaptations:{online:m(((i=l.adaptations)==null?void 0:i.online)||""),accessibility:m(((V=l.adaptations)==null?void 0:V.accessibility)||"")}}});u.value=g.map((l,i)=>({id:`activity-${i}`,...l,status:"pending"})),d.setActivitySuggestions(g),d.addDesignStep({id:a.step_id,session_id:d.sessionId,phase:"activity-suggestion",user_input:d.courseContext.learning_objectives,created_at:new Date().toISOString()}),u.value.length===0&&(s.parse_error&&s.raw_response?p.value="The AI response could not be parsed as valid JSON. Try again, or adjust the prompt/model.":p.value="No activities were returned. Try generating again, or refine your objectives.")}catch(a){if(console.error("Generation failed:",a),a&&typeof a=="object"&&"response"in a){const s=a;p.value=((e=(n=s.response)==null?void 0:n.data)==null?void 0:e.detail)||"Generation failed. Please try again."}else p.value="Generation failed. Please try again."}finally{b.value=!1}}}async function A(n,e,a,s){if(B.value)try{await Z({step_id:B.value,recommendation_id:H.value||void 0,action_type:e,edited_content:a,comment:s||n})}catch(w){console.error("Failed to save action:",w)}}async function T(n){const e=u.value.find(a=>a.id===n);e&&(e.status="accepted",await A(n,"accept",JSON.stringify(e)))}async function I(n){const e=u.value.find(a=>a.id===n);e&&(e.status="rejected",await A(n,"reject"))}function U(n){const e=u.value.find(a=>a.id===n);e&&(e.status="editing",e.draft={title:e.title||"",type:e.type||"",description:e.description||"",duration:e.duration||"",materials_needed:(e.materials_needed||[]).join(", ")})}async function $(n){const e=u.value.find(a=>a.id===n);e!=null&&e.draft&&(e.title=e.draft.title,e.type=e.draft.type,e.description=e.draft.description,e.duration=e.draft.duration,e.materials_needed=e.draft.materials_needed.split(",").map(a=>a.trim()).filter(Boolean),e.status="pending",delete e.draft,d.setActivitySuggestions(u.value.map(({id:a,status:s,draft:w,...g})=>g)),await A(n,"edit",JSON.stringify(e),"Edited activity content"))}function N(n){const e=u.value.find(a=>a.id===n);e&&(e.status="pending",delete e.draft)}async function D(n){await A(n,"regenerate"),alert('Regeneration for single activity coming soon! Click "Generate Activity Suggestions" to get new suggestions.')}function E(){d.setCurrentPhase("summary"),L.push("/summary")}function R(n){switch(n){case"accepted":return"bg-emerald-100 text-emerald-700";case"rejected":return"bg-red-100 text-red-700";case"editing":return"bg-amber-100 text-amber-700";default:return"bg-surface-100 text-surface-600"}}function F(n){switch((n==null?void 0:n.toLowerCase())||""){case"discussion":return"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z";case"project":case"lab":return"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10";case"assessment":case"reflection":return"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4";case"presentation":return"M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z";case"case study":case"simulation":return"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2";default:return"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"}}function O(n){switch((n==null?void 0:n.toLowerCase())||""){case"discussion":return"bg-violet-100 text-violet-600";case"project":case"lab":return"bg-amber-100 text-amber-600";case"assessment":case"reflection":return"bg-brand-100 text-brand-600";case"presentation":return"bg-blue-100 text-blue-600";case"case study":case"simulation":return"bg-rose-100 text-rose-600";default:return"bg-surface-100 text-surface-600"}}return(n,e)=>{var a;return r(),o("div",ee,[e[22]||(e[22]=t("div",{class:"mb-8"},[t("h1",{class:"text-2xl font-bold text-surface-900 mb-2"},"Activity Suggestions"),t("p",{class:"text-surface-600"}," Generate AI-powered learning activity suggestions based on your objectives. ")],-1)),h.value&&!h.value.configured?(r(),o("div",te,[t("div",se,[e[2]||(e[2]=t("svg",{class:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),t("div",null,[e[1]||(e[1]=t("div",{class:"font-medium text-amber-800"},"LLM Not Configured",-1)),t("p",ne,c(h.value.message),1)])])])):v("",!0),t("div",ae,[t("div",oe,[e[5]||(e[5]=t("div",null,[t("h2",{class:"font-semibold text-surface-900"},"Generate Activities"),t("p",{class:"text-sm text-surface-500 mt-1"},"Get contextual suggestions for learning activities aligned with your objectives.")],-1)),t("button",{onClick:G,disabled:b.value||((a=h.value)==null?void 0:a.configured)===!1,class:"btn-primary"},[b.value?(r(),o("svg",ie,[...e[3]||(e[3]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(r(),o("svg",le,[...e[4]||(e[4]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"},null,-1)])])),t("span",null,c(b.value?"Generating...":"Generate Activity Suggestions (AI)"),1)],8,re)])]),p.value?(r(),o("div",de,c(p.value),1)):v("",!0),k.value||_.value?(r(),o("div",ue,[k.value?(r(),o("div",ce,[e[6]||(e[6]=t("div",{class:"text-sm font-medium text-surface-700 mb-1"},"Sequence Rationale",-1)),t("p",me,c(k.value),1)])):v("",!0),_.value?(r(),o("div",pe,[e[7]||(e[7]=t("div",{class:"text-sm font-medium text-surface-700 mb-1"},"Total Estimated Time",-1)),t("p",fe,c(_.value),1)])):v("",!0)])):v("",!0),u.value.length>0?(r(),o("div",ve,[(r(!0),o(C,null,z(u.value,(s,w)=>{var g,l;return r(),o("div",{key:s.id,class:j(["card p-6 animate-slide-up",{"border-emerald-300 bg-emerald-50/50":s.status==="accepted","border-red-300 bg-red-50/50 opacity-60":s.status==="rejected"}]),style:Q({animationDelay:`${w*100}ms`})},[t("div",ge,[t("div",{class:j(["w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0",O(s.type)])},[(r(),o("svg",xe,[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:F(s.type)},null,8,be)]))],2),t("div",he,[t("div",ke,[s.status!=="editing"?(r(),o("h3",_e,c(s.title),1)):M((r(),o("input",{key:1,"onUpdate:modelValue":i=>s.draft.title=i,class:"w-full max-w-xl bg-white border border-surface-200 rounded px-3 py-1.5 text-sm",placeholder:"Activity title"},null,8,we)),[[S,s.draft.title]]),t("span",{class:j(["badge text-xs capitalize flex-shrink-0",R(s.status)])},c(s.status),3)]),s.status==="editing"?(r(),o("div",ye,[t("div",Ce,[t("div",null,[e[8]||(e[8]=t("div",{class:"text-xs text-surface-500 mb-1"},"Type",-1)),M(t("input",{"onUpdate:modelValue":i=>s.draft.type=i,class:"w-full bg-white border border-surface-200 rounded px-3 py-1.5 text-sm",placeholder:"e.g. Discussion / Case Study / Project"},null,8,je),[[S,s.draft.type]])]),t("div",null,[e[9]||(e[9]=t("div",{class:"text-xs text-surface-500 mb-1"},"Duration",-1)),M(t("input",{"onUpdate:modelValue":i=>s.draft.duration=i,class:"w-full bg-white border border-surface-200 rounded px-3 py-1.5 text-sm",placeholder:"e.g. 45 minutes"},null,8,Me),[[S,s.draft.duration]])])]),t("div",null,[e[10]||(e[10]=t("div",{class:"text-xs text-surface-500 mb-1"},"Description",-1)),M(t("textarea",{"onUpdate:modelValue":i=>s.draft.description=i,rows:"4",class:"w-full bg-white border border-surface-200 rounded px-3 py-2 text-sm",placeholder:"Activity description"},null,8,Se),[[S,s.draft.description]])]),t("div",null,[e[11]||(e[11]=t("div",{class:"text-xs text-surface-500 mb-1"},"Materials (comma-separated)",-1)),M(t("input",{"onUpdate:modelValue":i=>s.draft.materials_needed=i,class:"w-full bg-white border border-surface-200 rounded px-3 py-1.5 text-sm",placeholder:"e.g. laptop, worksheet, slides"},null,8,Ae),[[S,s.draft.materials_needed]])])])):(r(),o(C,{key:1},[t("p",Ve,c(s.description),1),t("div",Le,[t("span",Be,[e[12]||(e[12]=t("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),x(" "+c(s.duration),1)]),t("span",He,c(s.type),1)])],64)),(g=s.objective_alignment)!=null&&g.length?(r(),o("div",ze,[e[13]||(e[13]=t("div",{class:"text-xs text-surface-500 mb-1"},"Aligns with:",-1)),t("div",Ge,[(r(!0),o(C,null,z(s.objective_alignment,(i,V)=>(r(),o("span",{key:V,class:"text-xs px-2 py-0.5 bg-brand-50 text-brand-700 rounded"},c(i),1))),128))])])):v("",!0),(l=s.materials_needed)!=null&&l.length?(r(),o("div",Te,[e[14]||(e[14]=t("span",{class:"font-medium"},"Materials:",-1)),x(" "+c(s.materials_needed.join(", ")),1)])):v("",!0)]),t("div",Ie,[s.status==="editing"?(r(),o(C,{key:0},[t("button",{onClick:i=>$(s.id),class:"btn-success text-sm px-3 py-1.5"}," Save ",8,Ue),t("button",{onClick:i=>N(s.id),class:"btn-secondary text-sm px-3 py-1.5"}," Cancel ",8,$e)],64)):(r(),o(C,{key:1},[t("button",{onClick:i=>T(s.id),disabled:s.status==="accepted",class:j(["btn-success text-sm px-3 py-1.5",{"opacity-50 cursor-not-allowed":s.status==="accepted"}])},[...e[15]||(e[15]=[t("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),x(" Accept ",-1)])],10,Ne),t("button",{onClick:i=>U(s.id),class:"btn-secondary text-sm px-3 py-1.5"},[...e[16]||(e[16]=[t("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),x(" Edit ",-1)])],8,De),t("button",{onClick:i=>I(s.id),disabled:s.status==="rejected",class:j(["btn-danger text-sm px-3 py-1.5",{"opacity-50 cursor-not-allowed":s.status==="rejected"}])},[...e[17]||(e[17]=[t("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),x(" Reject ",-1)])],10,Ee),t("button",{onClick:i=>D(s.id),class:"btn-ghost text-sm px-3 py-1.5",title:"Regenerate this suggestion"},[...e[18]||(e[18]=[t("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])],8,Re)],64))])])],6)}),128))])):p.value?v("",!0):(r(),o("div",Fe,[...e[19]||(e[19]=[t("svg",{class:"w-16 h-16 mx-auto mb-4 text-surface-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})],-1),t("h3",{class:"text-lg font-medium text-surface-900 mb-2"},"No Activities Generated Yet",-1),t("p",{class:"text-surface-500 max-w-md mx-auto"},' Click the "Generate Activity Suggestions" button above to get AI-powered recommendations based on your learning objectives. ',-1)])])),t("div",Oe,[t("button",{onClick:e[0]||(e[0]=s=>K(L).push("/objective-analysis")),class:"btn-secondary"},[...e[20]||(e[20]=[t("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 17l-5-5m0 0l5-5m-5 5h12"})],-1),x(" Back to Analysis ",-1)])]),t("button",{onClick:E,class:"btn-primary"},[...e[21]||(e[21]=[x(" Continue to Summary ",-1),t("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7l5 5m0 0l-5 5m5-5H6"})],-1)])])])])}}});export{Ke as default};
